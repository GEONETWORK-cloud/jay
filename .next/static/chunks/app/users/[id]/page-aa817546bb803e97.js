(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7676],{4756:function(e,s,r){Promise.resolve().then(r.bind(r,5758))},5758:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return m}});var a=r(7437),l=r(2265),t=r(7907),n=r(9),i=r(1441),d=r(2406),o=r(8121),c=r(4499),u=r(1657);function m(){let[e,s]=(0,l.useState)(null),[r,m]=(0,l.useState)(!0),[x,h]=(0,l.useState)(!1),[g,p]=(0,l.useState)(""),[f,b]=(0,l.useState)("user"),[j,v]=(0,l.useState)(null),y=(0,t.useRouter)(),N=(0,t.useParams)(),{user:w}=(0,d.useAuth)(),k=Array.isArray(N.id)?N.id[0]:N.id,E=(null==w?void 0:w.email)==="rennielgeogeanga12@gmail.com";(0,l.useEffect)(()=>{if(!w){y.push("/login");return}if(!E){y.push("/");return}!async function(){if(w)try{m(!0),v(null);let e=(0,o.JU)(c.db,"users",k),r=await (0,o.QT)(e);if(!r.exists()){v("User not found"),m(!1);return}let a=r.data();s({id:r.id,...a}),p(a.displayName||""),b(a.role||"user")}catch(e){console.error("Error loading user:",e),v("Failed to load user data. Please try again later.")}finally{m(!1)}}()},[w,k,y,E]);let S=async s=>{if(s.preventDefault(),!w){y.push("/login");return}try{if(h(!0),v(null),"admin"===f&&(null==e?void 0:e.email)!=="rennielgeogeanga12@gmail.com"){v("Cannot set admin role for this user"),h(!1);return}let s=(0,o.JU)(c.db,"users",k);await (0,o.r7)(s,{displayName:g,role:f,updatedAt:new Date}),(0,u.c0)("User updated successfully","success"),y.push("/users")}catch(e){console.error("Error saving user:",e),v("Failed to update user. Please try again."),h(!1)}};return w&&E?(0,a.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,a.jsx)(i.Z,{}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("button",{onClick:()=>y.push("/users"),className:"flex items-center text-gray-600 hover:text-gray-900",children:[(0,a.jsx)(n.Ao2,{className:"mr-2"}),"Back to Users"]}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mt-4",children:"Edit User"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Update user information and permissions"})]}),j&&(0,a.jsxs)("div",{className:"mb-6 bg-red-100 border-l-4 border-red-500 text-red-700 p-4 flex items-start",children:[(0,a.jsx)(n.bcx,{className:"mt-0.5 mr-2 flex-shrink-0"}),(0,a.jsx)("span",{children:j})]}),r?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-8 flex justify-center",children:(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsxs)("form",{onSubmit:S,className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,a.jsxs)("div",{className:"flex items-center border rounded-lg px-3 py-2 bg-gray-50 text-gray-500",children:[(0,a.jsx)(n.Imn,{className:"mr-2"}),(0,a.jsx)("span",{children:null==e?void 0:e.email})]}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Email cannot be changed"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),(0,a.jsxs)("div",{className:"flex items-center border rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gray-50 p-2 text-gray-500",children:(0,a.jsx)(n.fzv,{})}),(0,a.jsx)("input",{id:"displayName",type:"text",value:g,onChange:e=>p(e.target.value),className:"block w-full px-3 py-2 outline-none",placeholder:"Enter display name"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),(0,a.jsxs)("div",{className:"flex items-center border rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gray-50 p-2 text-gray-500",children:(0,a.jsx)(n.E25,{})}),(0,a.jsxs)("select",{id:"role",value:f,onChange:e=>b(e.target.value),className:"block w-full px-3 py-2 outline-none",children:[(0,a.jsx)("option",{value:"user",children:"User"}),(0,a.jsx)("option",{value:"editor",children:"Editor"}),"rennielgeogeanga12@gmail.com"===w.email&&(0,a.jsx)("option",{value:"admin",children:"Admin"})]})]})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",className:"bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:x,children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{children:"Saving..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.mW3,{size:18}),(0,a.jsx)("span",{children:"Save Changes"})]})})})]})})]})]}):null}}},function(e){e.O(0,[4358,5239,8218,201,8792,8156,127,2971,8069,1744],function(){return e(e.s=4756)}),_N_E=e.O()}]);