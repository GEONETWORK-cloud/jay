(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5329],{7498:function(e,t,a){Promise.resolve().then(a.bind(a,7658))},7658:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var r=a(7437),s=a(2265),n=a(7907),l=a(1441),i=a(9);let d=[{label:"Blue",value:"bg-blue-500"},{label:"Green",value:"bg-green-500"},{label:"Red",value:"bg-red-500"},{label:"Purple",value:"bg-purple-500"},{label:"Yellow",value:"bg-yellow-500"},{label:"Indigo",value:"bg-indigo-500"}],o=[{label:"Meeting",value:"meeting"},{label:"Task",value:"task"},{label:"Reminder",value:"reminder"},{label:"Other",value:"other"}];function c(e){let{event:t,onSave:a,onCancel:n,isOpen:l}=e,[c,u]=(0,s.useState)(""),[m,g]=(0,s.useState)(""),[h,x]=(0,s.useState)(""),[b,v]=(0,s.useState)(""),[f,p]=(0,s.useState)(""),[y,j]=(0,s.useState)(""),[D,w]=(0,s.useState)(!1),[N,E]=(0,s.useState)("meeting"),[S,C]=(0,s.useState)("bg-blue-500"),[k,F]=(0,s.useState)(!1),[T,M]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(t){if(u(t.title||""),g(t.description||""),t.startDate){let e=t.startDate instanceof Date?t.startDate:new Date(t.startDate.toDate());x(A(e)),D||v(U(e))}else{let e=new Date;x(A(e)),v(U(e))}if(t.endDate){let e=t.endDate instanceof Date?t.endDate:new Date(t.endDate.toDate());p(A(e)),D||j(U(e))}w(t.allDay||!1),E(t.type||"meeting"),C(t.color||"bg-blue-500")}else{let e=new Date;x(A(e)),v(U(e));let t=new Date(e.getTime()+36e5);p(A(t)),j(U(t))}},[t,D]);let A=e=>e.toISOString().split("T")[0],U=e=>e.toTimeString().substring(0,5),I=async e=>{e.preventDefault(),M(null);try{let e;if(!c.trim()){M("Event title is required");return}if(!h){M("Start date is required");return}let t=new Date("".concat(h,"T").concat(D?"00:00":b)),r=new Date,s=new Date(r);if(s.setHours(1,0,0,0),t<s){M("Start time must be at least 1:00 AM");return}if(f){if((e=new Date("".concat(f,"T").concat(D?"23:59":y||"23:59")))<t){M("End time cannot be before start time");return}let a=new Date(e);if(a.setHours(23,0,0,0),e>a){M("End time cannot be after 11:00 PM");return}}F(!0);let n={title:c,description:m,startDate:t,endDate:e,allDay:D,type:N,color:S,createdBy:"currentUser"};await a(n)}catch(e){console.error("Error submitting event:",e),M("Failed to save event. Please try again.")}finally{F(!1)}},B=(e,t)=>{if(!e)return!0;let[a,r]=e.split(":").map(Number);return t?a>=1:a<=23},Y=(e,t)=>{let a=e.target.value;B(a,t)?t?v(a):j(a):M(t?"Start time must be at least 1:00 AM":"End time cannot be after 11:00 PM")};return l?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center bg-indigo-600 text-white p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-medium",children:(null==t?void 0:t.id)?"Edit Event":"Add New Event"}),(0,r.jsx)("button",{onClick:n,className:"text-white hover:text-gray-200",title:"Close","aria-label":"Close",children:(0,r.jsx)(i.q5L,{size:24})})]}),(0,r.jsxs)("form",{onSubmit:I,className:"p-6 space-y-4",children:[T&&(0,r.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4",children:T}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Title*"}),(0,r.jsx)("input",{id:"title",type:"text",value:c,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter event title",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("textarea",{id:"description",value:m,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500",rows:3,placeholder:"Enter event description"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{id:"allDay",type:"checkbox",checked:D,onChange:e=>w(e.target.checked),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"allDay",className:"ml-2 block text-sm text-gray-700",children:"All-day event"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date*"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(i.vlc,{className:"text-gray-400"})}),(0,r.jsx)("input",{id:"startDate",type:"date",value:h,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500",required:!0})]})]}),!D&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"startTime",className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time (min 1:00 AM)"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(i.TCC,{className:"text-gray-400"})}),(0,r.jsx)("input",{id:"startTime",type:"time",value:b,onChange:e=>Y(e,!0),min:"01:00",className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(i.vlc,{className:"text-gray-400"})}),(0,r.jsx)("input",{id:"endDate",type:"date",value:f,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"})]})]}),!D&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"endTime",className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time (max 11:00 PM)"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(i.TCC,{className:"text-gray-400"})}),(0,r.jsx)("input",{id:"endTime",type:"time",value:y,onChange:e=>Y(e,!1),max:"23:00",className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Type"}),(0,r.jsx)("select",{id:"type",value:N,onChange:e=>E(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500",children:o.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"color",className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),(0,r.jsx)("select",{id:"color",value:S,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500",children:d.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,r.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:k,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:k?"Saving...":"Save Event"})]})]})]})}):null}var u=a(2406),m=a(4499),g=a(8121),h=a(1657);function x(e){if(e)return e instanceof g.EK?e:g.EK.fromDate(e)}function b(e){if(e)return e instanceof Date?e:e.toDate()}async function v(e,t){try{if(!m.I8.currentUser)throw Error("User must be authenticated");let a=(0,g.hJ)(m.db,"calendarEvents"),r=new Date(e,t,1),s=new Date(e,t+1,0,23,59,59),n=(0,g.IO)(a,(0,g.ar)("createdBy","==",m.I8.currentUser.uid),(0,g.ar)("startDate",">=",x(r)),(0,g.ar)("startDate","<=",x(s)),(0,g.Xo)("startDate","asc"));return(await (0,g.PL)(n)).docs.map(e=>{let t=e.data();return{id:e.id,...t,startDate:b(t.startDate),endDate:b(t.endDate),createdAt:b(t.createdAt),updatedAt:b(t.updatedAt)}})}catch(e){throw console.error("Error loading events by month:",e),(0,h.c0)("Failed to load calendar events","error"),e}}async function f(e){try{if(!m.I8.currentUser)throw Error("User must be authenticated");let t=(0,g.hJ)(m.db,"calendarEvents"),a={...e,startDate:x(e.startDate),endDate:x(e.endDate),createdBy:m.I8.currentUser.uid,createdAt:(0,g.Bt)(),updatedAt:(0,g.Bt)()},r={id:(await (0,g.ET)(t,a)).id,...e,createdBy:m.I8.currentUser.uid,startDate:e.startDate,endDate:e.endDate};return(0,h.c0)("Event created successfully","success"),r}catch(e){throw console.error("Error creating calendar event:",e),(0,h.c0)("Failed to create event","error"),e}}async function p(e,t){try{if(!m.I8.currentUser)throw Error("User must be authenticated");let a=(0,g.JU)(m.db,"calendarEvents",e),r=await (0,g.QT)(a);if(!r.exists())throw Error("Event not found");if(r.data().createdBy!==m.I8.currentUser.uid)throw Error("Not authorized to update this event");let s={...t,startDate:x(t.startDate),endDate:x(t.endDate),updatedAt:(0,g.Bt)()};return await (0,g.r7)(a,s),(0,h.c0)("Event updated successfully","success"),!0}catch(e){throw console.error("Error updating calendar event:",e),(0,h.c0)("Failed to update event","error"),e}}async function y(e){try{if(!m.I8.currentUser)throw Error("User must be authenticated");let t=(0,g.JU)(m.db,"calendarEvents",e),a=await (0,g.QT)(t);if(!a.exists())throw Error("Event not found");if(a.data().createdBy!==m.I8.currentUser.uid)throw Error("Not authorized to delete this event");return await (0,g.oe)(t),(0,h.c0)("Event deleted successfully","success"),!0}catch(e){throw console.error("Error deleting calendar event:",e),(0,h.c0)("Failed to delete event","error"),e}}let j=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],D=["January","February","March","April","May","June","July","August","September","October","November","December"];function w(){let[e,t]=(0,s.useState)(new Date),[a,d]=(0,s.useState)([]),[o,m]=(0,s.useState)(null),[g,x]=(0,s.useState)(!0),[b,w]=(0,s.useState)(!1),[N,E]=(0,s.useState)(void 0),S=(0,n.useRouter)(),{user:C}=(0,u.useAuth)(),k=e.getMonth(),F=e.getFullYear(),T=new Date(F,k,1),M=new Date(F,k+1,0).getDate(),A=T.getDay();(0,s.useEffect)(()=>{if(!C){S.push("/login");return}!async function(){try{x(!0);let e=await v(F,k);d(e)}catch(e){console.error("Error loading calendar events:",e),(0,h.c0)("Failed to load calendar events","error")}finally{x(!1)}}()},[F,k,C,S]);let U=e=>{E(e),w(!0)},I=async e=>{if(window.confirm("Are you sure you want to delete this event?"))try{await y(e),d(a.filter(t=>t.id!==e)),(0,h.c0)("Event deleted successfully","success")}catch(e){console.error("Error deleting event:",e),(0,h.c0)("Failed to delete event","error")}},B=async e=>{try{if(null==N?void 0:N.id)await p(N.id,e),d(t=>t.map(t=>t.id===N.id?{...t,...e,id:N.id}:t)),(0,h.c0)("Event updated successfully","success");else{let t=await f({...e,createdBy:(null==C?void 0:C.uid)||"anonymous"});t.startDate instanceof Date&&t.startDate.getMonth()===k&&t.startDate.getFullYear()===F&&d(e=>[...e,t]),(0,h.c0)("Event created successfully","success")}w(!1),E(void 0)}catch(e){console.error("Error saving event:",e),(0,h.c0)("Failed to save event","error")}},Y=[];for(let e=0;e<A;e++){let t=new Date(F,k,0-(A-e-1));Y.push({date:t,isPreviousMonth:!0})}for(let e=1;e<=M;e++){let t=new Date(F,k,e);Y.push({date:t,isCurrentMonth:!0})}let P=42-Y.length;for(let e=1;e<=P;e++){let t=new Date(F,k+1,e);Y.push({date:t,isNextMonth:!0})}let z=o?a.filter(e=>e.startDate instanceof Date&&e.startDate.getDate()===o.getDate()&&e.startDate.getMonth()===o.getMonth()&&e.startDate.getFullYear()===o.getFullYear()):[],O=e=>a.filter(t=>t.startDate instanceof Date&&t.startDate.getDate()===e.getDate()&&t.startDate.getMonth()===e.getMonth()&&t.startDate.getFullYear()===e.getFullYear()),J=e=>e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return(0,r.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,r.jsx)(l.Z,{}),(0,r.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:[(0,r.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Calendar"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage your schedule and events"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>{t(new Date),m(new Date)},className:"px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:"Today"}),(0,r.jsx)("button",{onClick:()=>{t(new Date(F,k-1,1)),m(null)},className:"p-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:(0,r.jsx)(i.YFh,{})}),(0,r.jsx)("button",{onClick:()=>{t(new Date(F,k+1,1)),m(null)},className:"p-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:(0,r.jsx)(i.Tfp,{})}),(0,r.jsxs)("div",{className:"px-4 py-2 font-medium",children:[D[k]," ",F]})]})]}),g?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow p-8 flex justify-center",children:(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,r.jsx)("div",{className:"grid grid-cols-7 border-b",children:j.map(e=>(0,r.jsx)("div",{className:"p-2 text-center text-sm font-medium text-gray-500",children:e},e))}),(0,r.jsx)("div",{className:"grid grid-cols-7 grid-rows-6",children:Y.map((e,t)=>{let a=O(e.date),s=e.date.toDateString()===new Date().toDateString(),n=o&&e.date.toDateString()===o.toDateString();return(0,r.jsxs)("div",{onClick:()=>m(e.date),className:"\n                      min-h-24 p-1 border-t border-r\n                      ".concat(e.isCurrentMonth?"bg-white":"bg-gray-50 text-gray-400"," \n                      ").concat(s?"border-blue-500 border-t-2":"","\n                      ").concat(n?"bg-blue-50":"","\n                      cursor-pointer hover:bg-gray-50\n                    "),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,r.jsx)("span",{className:"text-sm ".concat(s?"font-bold text-blue-500":""),children:e.date.getDate()}),a.length>0&&(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[a.slice(0,2).map(e=>(0,r.jsx)("div",{className:"text-xs p-1 rounded truncate text-white ".concat(e.color),onClick:t=>{t.stopPropagation(),U(e)},children:e.title},e.id)),a.length>2&&(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["+",a.length-2," more"]})]})]},t)})})]}),o&&(0,r.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h2",{className:"text-lg font-medium",children:["Events for ",o.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),(0,r.jsxs)("button",{onClick:()=>{E(o?{startDate:o}:void 0),w(!0)},className:"flex items-center gap-1 text-indigo-600 hover:text-indigo-800",children:[(0,r.jsx)(i.OvN,{size:16}),(0,r.jsx)("span",{children:"Add Event"})]})]}),z.length>0?(0,r.jsx)("div",{className:"space-y-3",children:z.map(e=>(0,r.jsxs)("div",{className:"flex items-center p-3 border rounded-lg hover:bg-gray-50",children:[(0,r.jsx)("div",{className:"w-4 h-4 rounded-full ".concat(e.color," mr-3")}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-medium",children:e.title}),e.startDate instanceof Date&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:e.allDay?"All day":J(e.startDate)+(e.endDate instanceof Date?" - ".concat(J(e.endDate)):"")}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>U(e),className:"p-1 text-gray-500 hover:text-indigo-600",children:(0,r.jsx)(i.IYd,{size:16})}),(0,r.jsx)("button",{onClick:()=>e.id&&I(e.id),className:"p-1 text-gray-500 hover:text-red-600",children:(0,r.jsx)(i.Ybf,{size:16})})]})]},e.id))}):(0,r.jsxs)("div",{className:"text-center py-4 text-gray-500",children:[(0,r.jsx)(i.vlc,{className:"mx-auto mb-2",size:24}),(0,r.jsx)("p",{children:"No events scheduled for this day"})]})]}),(0,r.jsx)(c,{event:N,isOpen:b,onSave:B,onCancel:()=>{w(!1),E(void 0)}})]})]})}}},function(e){e.O(0,[4358,5239,8218,201,8792,8156,127,2971,8069,1744],function(){return e(e.s=7498)}),_N_E=e.O()}]);